async function s(t,e){try{const o=await fetch(`/post/${t}/comments/`);if(!o.ok)throw new Error("Failed to fetch comments");const n=await o.json();e.innerHTML="",n.forEach(c=>{const r=document.createElement("li");r.textContent=`${c.author_username||"Anonymous"}: ${c.body}`,e.appendChild(r)})}catch(o){console.error("Error fetching comments:",o),e.innerHTML="<li>Error loading comments. Please refresh the page.</li>"}}async function m(t,e,o){try{if(!(await fetch(`/post/${t}/comments/`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":a("csrftoken")},body:JSON.stringify({body:e})})).ok)throw new Error("Failed to post comment");return await s(t,o),!0}catch(n){return console.error("Error submitting comment:",n),alert("Failed to post comment. Please try again."),!1}}function a(t){let e=null;if(document.cookie&&document.cookie!==""){const o=document.cookie.split(";");for(const n of o){const c=n.trim();if(c.startsWith(t+"=")){e=decodeURIComponent(c.substring(t.length+1));break}}}return e}const i=document.getElementById("comment-list"),l=document.getElementById("submit-comment");l.addEventListener("click",async()=>{const t=document.getElementById("comment-content").value.trim();t&&(await m(postId,t,i),document.getElementById("comment-content").value="")});s(postId,i);
